module Day13 where
import Data.List (transpose)
import Data.Maybe
input = [["#.######.#.","....##.#...","..######...","###....###.","#..####..##",".#.#..#.#.#",".#.#..#.#.#","##......###","..........#",".#.####.#.#",".#......#.#",".#......#.#",".#.####.#.#"],[".##...#.#...#","#######..#.#.","#..#.######.#","....###..##.#","......##.....","#..##..#...##","#..####.#....","###.#..##....","............#","#..#..#####.#","#..#..#####.#"],["##..#######..",".#.####.#.#..",".#.#..#..##.#","...#..#.##.#.","#.#..#....##.","#.#..#....##.","...#..#.##.#.",".#.#..#..##.#",".#.##.#.#.#..","##..#######..","#.#.##.#.....","#.....###..#.","###.....###.#","###.....###.#","#.....###..#.","#.#.##.#.....","##..#######.."],["#...#.##.","#...#.##.","..#.#....","...#.....",".##.##..#","##...####","#.#.#####","#.##.#...",".###.....","#.#.#####","###.##..#",".#..##..#",".#....##."],["#..#.#.####","....#..#.#.",".##.#..####",".##...#..#.","####....#..","#####.##.#.","#####.##.#.","####....#..",".##...#..#.",".##.#..####",".......#.#.","#..#.#.####","....#...##.",".##.##.##.#","#..###.#..#","#..###.#.#.","....##.###."],["##.##..##",".##.#..#.","#..##..#.","#.#.#..#.","....####.","##..#..#.",".#..####.",".##.####.","...#....#","...#....#",".##.####."],["..#.#.##.","##..#.##.","##...#..#","##..##..#","##..##..#","##...#..#",".#..#.##.","..#.#.##.","..###....",".#.#.####",".#..#.##.","..##..##.","###..#..#","##.#.....","...#....."],["######....#","##..###..##","#.####.##.#",".......##..",".####.#..#.","......####.","#....#.##.#","......#..#.","#....#....#"],[".#....###","#.#######","#.#######",".#....###","..##.#...",".###.#.##",".#...#.##","..####.##","...##..#."],["##.#.#.#.####.#","####.#..#....#.","####.#..##..###","#...###..#..#..","#.#.#..#.####.#","###...#.##..##.",".#....#.##..##.",".#....#.##..##.","###...#.##..##."],["######.##.#.##..#","..##..#.#..#..#.#","..##......#.#..##",".......##.##.#.##","..##..##....#...#","########..#####.#","#....#.###.#...#.","#########..#.#..#","######..#.#.###.#"],["####.#.###.#.##","...##.#..##.###","#.##.#..##.#.##",".##..##.######.","#.#...#.#..##.#",".......##..##.#","#.###......#.#.","#.###......#.#.",".......##..##.#","#.#...#.#..##.#",".##...#.######.","#.##.#..##.#.##","...##.#..##.###","####.#.###.#.##","####.#.###.#.##"],["..####.##","....#.#..","..#......","....#..#.","####..#..","###....#.","###..##.#","###...#..","###.#...#","###.#...#","###.#.#..","###..##.#","###....#.","####..#..","....#..#."],["###...#...#","###..#..#.#",".#.##.#..##",".#.#..##.##","#...##.#..#",".##.....#..","..#..######",".....#.##.#",".#..#.###.#","#.#.#.#.#..","#.#.###.#..","#.#.###.#..","#.#.#.#.#.."],[".##.#..####.#.#..","###..#..###.#.###","##..###.....#..##","#........###..###","###.####..##.....","###.#.#....##.#..","###.#.#....##.#..","###.####..##.....","#........###..###","##..###.....#..##","###..#..###.#.###",".##.#..####.#.#..","......#..####.##.","##.#.#######.#...","#..#.#..#.#.#####","#....#.##.##..#..",".#....##..#......"],["...##..#.######.#",".######...#..#...","..#.#.#.##...###.","...#.#.#........#","##...#.#..####..#",".##.##.###....###","..#...###......##","###.#.#.#.#..#.#.",".#.#..#..#.##.#..",".##.#..###....###","#.#...##.#....#.#","####.#.##..##..##","####.#.##..##..##","#.#...##.#....#.#",".##.#..###....###",".#.#..#..#.##.#..","###.#.#.#.#..#.#."],["........#######","#######.#######","#..###..#######","....#..#.#..##.",".##.#.#.#.#.##.","##.##..##.#....","#..#.#...######",".....#.#..##..#","##########.####",".##.#.##.#.####","#..#...####.##.","#..##.##..#.##.",".##.#.....##..#","#..##..##.#####",".....##..##...."],["#..####.##.##",".##.##.####.#","#######.##.##","####.........","#..##..####..","....##.#..#.#",".##..#.####.#","....#.#....#.",".....##....##",".##.##.#..#.#","#..##..#..#..","####.######.#",".....#.####.#",".##.##......#","#..##........"],["#.#..#.",".######",".######","#......","...##..",".######","...##..","###..##",".######"],["##.#..#.##...",".##.##.##.#..","...####.....#","##..##..###.#",".#......#.##.","..##..##...#.","....##.....#.",".##.##.##.#.#","#.#.##...#.#.","##.#..#.#####","###....###.#.","..######....#","###....####..","....##.....#.","...####...#.#","###.##.###...","###.##.###..."],[".##.######..#",".##.######..#",".#.###.####..",".####.##..###","...#..###.###","###.....#..#.","..##.#.##..#.","..#.##..##.#.",".#..#.#.....#",".#..#.#.....#","..#.##..##.#.","..##.#.##..#.","###.....#..#.","...#..###.###",".####.##..###",".#.###.####..",".##..#####..#"],[".##.##..#",".#..####.",".#..####.",".#####..#","#.##...#.","...###..#","..##.#...","#.#.....#","#...#.#..","#...#.#..","#.#.....#","..##.#...","...###..#","#.##...#.",".#####..#"],["##..###..#...#.","#...###..#...#.",".#.#...##..####","#..#.##....#.##",".##.##.....####","...###.###.#.#.","#..#.####...#.#",".#..###...#....","....#.#######..",".#.#.#.##...###",".#.#.#.##...###"],[".##...#..#...##..","##..########..###","##..#..##..#..###","...##.#..#.##....",".#...##..##...#..","..##........##...","##.###....###.###","..##...##...##...","######....##.####","...##.#..#.##....",".....#....#......","...##......##....",".......##........"],[".##.###.#..","####......#",".##.####.##","#...##....#","#.##.#.....","#.##.#.....","#...##....#",".##.####.##","####......#",".##.###.#..","#...#.#####",".....#.##.#",".....#.##.#","#...#.#####",".##.###.#..","####.#....#",".##.####.##"],["#.##......##.#.#.","..#.#....#.#.....","..#.#....#.#.....","#.##......##.#.#.","####.#..#.####.##","#.##.#..#.##.#...","##...####...###.#","###.#.#..#.#####.","..###.##.###...##","#.##.#..#.##.##.#","..#..####..#....#","#.##.#..#.##.#.#.","#..##.##.##..#.#."],["#.####.#..###..","##....###.##...","..####..#.#####","#.####.#....#.#","#.####.#....#.#","..####..#.#####","##....###.##...","#.####.#..###..",".##..##....#.##","#......#.#...#.","##....#####.###","...##.....##.#.",".##..###.#.#.##",".######.#...###",".#....#....##.."],["#...#.##.###.","#...#.#.###.#","#...#.#.###.#","#...#.##.###.","##.#...##.#..","#.###..###.#.","###.#.#..#...",".##..###..#.#",".##..###..###","###.#.#..#...","#.###..###.#."],["..#.#..####..##","....#.#.####...","..####..#.#....","#######..###...","...#..###.#..##","##.#..#.#...###","##..#..#.######","##.....#.#.#.##","##.###.###..###","#......#.#.....","..##.#.#####.##"],["#.#.#..","##.##..","..#####","..##.##","..##.##","..#####","##.###.","#.#.#..","#......",".#....#",".#....#","#......","#.#.#.."],["##.#..##..#.#","..#..####..#.","##...#..#...#","..#.##..##.#.","###..#..#..##","..###.##.###.","##.##....##.#","##.##.##.####","###.#.##.#.##","##..##..##..#","..#..#..#..#."],["...#.#.","...#...","##.#...","..##.##","##..#.#","##..#..","###..##","##..#.#","###....","..#.##.","####..#"],["##...###.#.##","##...###.#.##","#..#..#..##..",".....#.###.#.","#.#.#..##.###","##...##.#..#.","##...##.#..#.","#.#.#..######",".....#.###.#.","#..#..#..##..","##...###.#.##"],["....#...######.","####.#.######.#","#..#####.#..#.#","####..#..#..#..","#..#.###.####.#","#..#.#..#.##.#.","#..#...#......#","#..#.#####..###","#####.##.#..#.#","####.##..####..","#..#.#..##..##.","#..#...##.##.##",".##..##########"],[".##..##..##..",".#.#.####.#..",".###....###..","..#.#..#.#...","###.#..#.####","##..####..###",".#..####..#..","##..####..###",".#...##...#..",".###....###..","##.#.##.#.###","##........###","..#..##..#..."],["..#..#....#..#..#",".....#....#......","..##........##...","#.#.#.#..#.#.#.#.","..#..#....#..#...","#..##..##..##..##","...##.####.##....","##............###","##............##."],[".....#.#.##.#...#","#..#.#..#.##.##..",".#.#.##.#.#...#..","..##.###..#.##.##","..#.####.##.#.##.","###.....#..###..#","....#.##...###...","....#.##...###...","###.....#..###..#","..#..###.##.#.##.","..##.###..#.##.##",".#.#.##.#.#...#..","#..#.#..#.##.##..",".....#.#.##.#...#",".....#.#.##.#...#"],["#..#..#","##.##.#","#....#.","#....#.","##.##.#","#..#..#",".#...#.","##.###.","..#..#.","..##.#.","##.###."],[".##...##.##",".##.#######",".##.###.##.","####.##..#.","#######.###",".##..#.##.#","....###.###","......#....","#..#.###.#.","#######..#.","#####.#.#.#",".##.##..##.",".##.##..##.","#####.#.#.#","######...#."],["###..####.###","##.##.##.##..","##.##.##.##..","###..####.###","#.#..#.#.##.#","#.#..#...#.##","........#..#."],["..#.####..##..#",".#..#.#........",".#..##.........","#....##........","...#.###..##..#","...##.#.##..##.",".##.#..........","..#..#.#..##..#","...#.##.##..##.","#...#..#..##..#",".#.....###..###",".#..#..........","#.####........."],["..#.##....#","##.##..#.##",".#.#..#....","#####.#....","###.#...###","###.####.##","##.....####","..#.##.##..","..#.##.##..","##.....####","###.####.##","###.#...###","#####.#....",".#.#..#....","##.##..#.##"],["#.##.##.##.#...","#####..#####.##","..#..##..#..#..",".####..####.#..","#.#......#.#...","#.#.####.#.#.#.",".....##........",".##..##..##.#..","#.#..##..#.####","#..#.##.#..####",".#.##..##.#....","............###",".#.#....#.#.###",".##########....","..########..###"],["....#..#..#..","......#....#.","#####.##..##.",".....##..#.##","#..####.##.##","....#.#.##.#.","#..##.#.##.#.","....####..###",".##.#........","#..#...####..","......#....#.","#..##........","#######.##.##","........##...",".....###..###"],["...###..#..##..","########..####.","#..#..#..######",".##.#.###.#..#.","#.###.#########","..#....##.####.","....##.##.####.","..#............","...###.........","...#.##.#.#..#.",".#.##.##....#..","##.#.#.##.#..#.","###.##...#.##.#","..##....#..##..","#.##..#...#..#.","......####....#","......####....#"],["#.#..##.#","#.##...#.","#........",".......#.",".......#.","#........","#.##...#.","#.#..##.#","..#..##..",".#..#..#.","...#####.","...#####.",".#..#..#.","..#..##..","###..##.#","#.##...#.","#........"],[".####..#.","#.##.#.##",".####.###","#....###.","#....###.",".####.###","#.##.#.##",".####..#.",".#..#.#.#",".......##","#...##.##","##..###.#","#....###.","######.#.","##..###.."],[".#.###..#...###",".#.###......###",".#.###......###",".#.###..#...###","#....###..####.","..##########...","###.#..##.#.##.","....#.#.#.#...#","###....##...##.","##...#..#..##.#",".#.#.#.#......."],["#.####.###.###.##",".#....#....##....","...##......#.#...","#####.##.....###.","..####...#.#...#.",".#.##.#...##..#.#","#......#####...##","..#..#....#.###..","..#..#....#.###..","#......#####...##",".#.##.#...##..#.#"],["######.#.#..##.","####...######..","....###.#.##.##","....#.#.#.##.##","####...######..","....#....######","#.#..#####...#.","#.#..#####...#.","....#....######","####...######..","....#.#.#.##.##","....###.#.##.##","####...######.."],["##....#.#.#..","###...#.#.#..","#..#...#....#","..#.###...###","#..#####.##.#",".#..#...#...#","##..##..#####",".#.#..####.#.","##..##.#.#.##","..####.#...##","..####.#...##"],["#.#.#..#..#","...#....##.","#.#.#..####","...####.##.","...####.##.","#.#.#..####","...#..#.##.","#.#.#..#..#","#.#..#..##.","###.#......","#..#.#.#..#",".####..#..#","#.#.####..#","#..##.#....","#.#..#.....","##.##.#....","..##..#####"],["..#.###","#..#...",".###.#.","..#....","#..###.","#..#.#.","..#....",".###.#.","#..#...","..#.###","..#.###"],[".........#...####","#######.#..#####.","##..##.#.....####",".......##.#####.#","......###.#....#.","......###.#....#.","#....#.##.#####.#","##..##.#.....####","#######.#..#####.",".........#...####","##..##..####....."],["....#..#..#..","##.#..######.","##..##..##..#","...##.#.##...","####.#......#","...#..######.","....###.##.##","##..#.######.","...#.##....##","...#....##...","...##.##..##.","##.####.##.##","..###..####.."],[".###.####","##...##.#","..#.#.##.","#.#..#.##","#.#.#.##.","#.#...##.","####.###.","####.###.","#.#...##.","#.#.#.##.","#.#..#.##","..#.#.###","##...##.#",".###.####",".###.####"],[".####..#####.","#.....#..#...","#.....#..#...",".####.######.","..#.....#..#.","..##.###....#","####.#.#...##","..####.#.##..",".###...###.##","###..##....#.","###..##....#."],["###.#...####...",".##...#####..##",".#..##....#....",".###...##....##",".#####.#...#...","....#.#...#.###",".####.###..#.##","....###..###...","....###..###...",".########..#.##","....#.#...#.###"],[".##.#.#.#.#","#..#..#...#","....#...#..","#..###.####","#..##.####.",".....##..#.","#..##.##..#","####.#...#.","#..#....#..","#..#....#..","######...#."],["#..###...",".##.#####",".......#.",".......#.",".##.#####","#..###...",".##..#.##","...#.#.#.",".##..###.",".....###.","#..##.###",".##..###.",".##......","#..#..#.#","....###.#","#..##.#.#",".##.#.#.#"],["###.#.###........",".#.#..#.#........",".#...##..########","#.####.##...##...",".#.#..#.###....##",".###.#...##....##","#.#..#..#..#..#..","##.#.#.#...#..#..","#######...#....#."],["##.#..##.####.##.","######....##....#","##.####..####..##","##...##.######.##",".....##...##...##","....###...##...##","..##.###..##..###","...######....####","##...#....##....#","..#######....####","...#.####....####","##.......#..#....","..#.##.#.#..#.#.#","##.#...########..","####..##.##.#.##."],[".##.####...#.",".....#..#....","#..####.#.##.",".##..#...#...","####.##.#.#.#","###.#....#..#","#..#.##...#..","####....#####",".##.##....#.#","#..#..#..##..","#..#..#..##..",".##.##....#.#","####....#####"],["#..#.##.#","##.#.##.#","...#.##.#","..#######",".#.##..##","#..##..##","##.######","..###..##",".##..###.","####....#","...######",".....##..",".....##..","...######","####....#",".##..###.","..###..##"],["####...","####...","##.####","......#","#....#.","#.#...#","..#....","..#....","#.....#"],["#..#...#.","##.#...#.","##.#...#.","#..#...#.","..#.....#","..##.##..",".#......#",".#.##.###","###.....#"],["#.####.#..##..##.","########.##.##.##","###..###.#.#..#.#","##....####.####.#","#..##..##.#....#.",".#.##.#.##.#..#.#","...##....#.####.#","#..##..########.#","##....##..#....#.","##....##.###..###","........#..#..#..",".........#.####.#",".#.##.#..########",".#....#.#########","##....##..#.##.#."],["##.#.....","#..#.....",".#....#..",".#..##.##","#...##..#","#..#..#.#","###.#....","..##.#..#","##..####.","######..#","######..#","##..####.","..##.#..#","###.#....","#..#..#.#","#...##..#",".#..##.##"],["#...###..####..","###..#..##..##.",".#.....##.##.#.","#.###.#.##...#.","###...###.#.###","###...###.#.###","#.###.#.##...#.",".#.....##.##.#.","###..#..##..##.","#...##...####..","###..##.#.####.","#....##...#.##.","#....##...#.##."],[".####.####..###","#.##.###.#..#.#","..##...##.#..##","######....##...","..##.....#..#..","##..##....##...","#....###..##..#"],[".#.##.#..","#.####.##","#.####.##",".#.##.#..","#.....###","#.#..#.#.","#.####.#."],["##.....##.#.#","#.#.####.....","..###......##","...#.....#.##","#.#..#.....#.","#.##....#.###","....#.##.#.#.","....#.##.#.#.","#.##....#.###","#.#..#.....#.","...#.....#.##","..###......##","#.#.####.....","##.....#..#.#","##.....#..#.#","#.#.####.....","..###......##"],[".#..#.#.##.#.##",".##.#####.#...#",".##.#####.#.#.#",".#..#.#.##.#.##","#..#.#..#.##...","....##.#.....##","#.##....####.#.","#..##...#.#...#","....##.#####...","##...#.###.....",".#...#..#..#.#.",".#...#..#..#.#.","##...#.###.....","....##.#####...","#..##...#.#...#"],["#......####.#.#.#","###..#######.##..","###..#######.##..","#......####.#.#.#","#.####.##.###.#.#","#..##..###...#...","...##...##...#...",".#.##.#..##.#.###","#########.###..#.","###..####.#####..",".##..#...##..##.#","###..####.#.##...","#.#..#.#.#.#..###","#.####.##..#.##.#",".######......####"],["..######...#..#","#.#....#.######","#.#....#.######","..######...#..#","..#....#...#...","#..####..#.####","...#..#.#.##...",".##.##.##.....#","#..#..#..#..##.","#.#.##.#.#...##","..#....#.....##","#.##..##.##..#.",".#.#..#.#..#..#"],[".#...##.###..#.",".#...##..##..#.",".#..#...#......","##...#.####.###","##.#.###.##.###","..#....####..##",".##..#####..#..","..###.#..#.###.","..###.#..#.###."],[".########..","#..#..#..##",".###..###.#","##.#..#.##.","..#.##.#..#","..#.##.#..#","##.#..#.###",".###..###.#","#..#..#..##",".########..",".#.####.#..","#..#..#..##","##########.","...#..#...#","##.####.###"],["###.###","#.#####",".#.##..","#.#.#..",".....##","..#.#..","#..##..","...#.##","...#.##","#..##..","#.#.#..",".....##","#.#.#..",".#.##..","#.#####","###.###","..#.#.."],["...#.#...","##..#..##","###.#..#.","##...##.#","##...#...","...#.#...","...#.#...","##...#...","##...##.#","###.#.##.","##..#..##","...#.#...","##.###.#."],["..#...####.",".#.##..##..",".###..####.",".#.###....#","##..#..##..","###..##..##",".....######","..#..##..##",".###...##..","###..#....#","#.####.##.#","#.####.##.#","##...#....#"],["####.#....##...",".##..#.###..###","#..###..##..##.","#..##.####..###","####...##....##","....#.#.#....#.","#...#####....##"],["####.#..#.#",".##..####..","#..#..##..#","####......#","######..###","#..###..###","....#....#.","...#..##..#","#####....##","#..#.#..#.#","######..###"],[".#..#..","#.#...#",".###..#","...##..",".#...#.",".#...#.","...##..",".###..#","#.#...#","....#..","#.....#","####.#.",".....##",".....##","####.#."],["####.#..#....#..#",".#..#.....##.....","..###..#.####.#..","..##.###.#..#.###","...####........##",".######..####..##",".#..#..###..###..",".##.###...##...##","...#.###......###"],["####.####","##...#.##","##...#.##","####.####","##.#.####","####..###","..#.##...","####..#.#",".....#...",".....##..",".#.####..","...#.##..","#..######"],[".##..####..",".##..####..","#...#.##.#.","#...#....#.","#.....###..","....##..##.",".#####..###"],["####..#.#####","...######....","#..#.##.#..##","#####..######","#.###..###.##","##........###","..##....##...","###..##..####","##...##...###","##..#..#..###",".#.######.#..","..#......#...","..#.#..#.#...","####....#####","##.##..##.###"],["##.#....##.......",".#...#####.######","#....#..#..#.##.#",".###..##..#......","#####.#..#.......",".#....#.###.#..#.","..#.###.##.......","...#...#.#..####.","###.##...##......",".#.#...######..##",".#.##..######..##"],[".##..##..",".##..##..","#..###...",".#...#...","##.#..#..","#..#..###","....#....",".######..",".##.#.#..","##.#.##..","...##...#","###..#.##","#.###..##","##.####..",".####.###"],["..####...##","..##.#.#...","..##.#.#...","..####....#","...####.#..","....#.#...#","...#..#....","##...#.....","..#.###.###","...#####.#.","#####..#..."],["#####.#....#.","#####......#.","#.######.#.##","#.######.#.##","#####......#.","#####.#....#.","##..#.#...#.#","##..#.#....##",".#####.##.###",".#.#...#.##.#","#.#.#####..##"],["#...########.#.##","#...########.#.##",".....###.#.#...##","..##..#.#.##.###.","###.#.#.###.###.#","..#..#.....###...","##.#.#.#.....##..",".##.##.##.####.#.","#..##.#..#.####..","#..##.#..#.####..",".##.##.##.####.#.","##.#.#.#.....##..","..#..#.....###...","###.#.#.###.###.#","..##..#.#..#.###.",".....###.#.#...##","#...########.#.##"],["####..####.","####.#..#..","....#..###.","####..###..","...##.#####","..##..##..#","##...#..#..","####..##.##","###...##.##","##.####..##","####......#","...#.....#.","...#.....#.","####.#....#","##.####..##"],["...#....##..#","......#.#..##","....#..##...#","....##.###.#.","##...###...#.","###.###....#.",".....####..##","..####..#..#.","..##..##.#.##","..##.......#.","...####.....#","..######.##.#","...#####.##.#"],[".#.##.#...#..","...##...##.#.","#.####.##.#.#","#.####.##.###","...##...##.#.",".#.##.#...#..","..........#.."],["##.##..#..#","#.##.####..","..##....###","#....##..##","...#...##.#","#.#..#.#.#.","##....####.","..#..###.##","..#..###.##","##....####.","#.#..#.#.#.","...#...##.#","#.#..##..##","..##....###","#.##.####..","##.##..#..#","##.##..#..#"],["...#.##.#.....#..","...#.##.#.....#..","#....###.#.###.##",".#####.##.#.#..#.","##..###.##..###..","#.#####.##.#....#","...#....#..##.##.","...#....#..##.##.","#.#####.##.#....#","#...###.##..###..",".#####.##.#.#..#."],["#.##.##.##.##","#...####...##","#.##....#####","###......####",".#.#.##.#.#..","###..##..####","#.###..###.##"],["##.#####.#####...","##.#.#####...####","..#..##.#.#.##.#.","###.#....##.#....","..##.#...........","####.#.##..#....#",".####..#..#...##.","###..####.#.##.#.","#######..#...#...","######..#....##..","..###.#.##.......","...#.####...###.#","...#.####...###.#"],["########.#.#..#","##.#..##..####.","#####..#.......","####.##..#.####","#..#.##.###.#..",".....#.#.#.####","#####....#...#.","#####.#.......#",".##...#..#.#...",".##...#..#.#...","#####.#.......#"]]
inputTestV = ["#.##..##.","..#.##.#.","##......#","##......#","..#.##.#.","..##..##.","#.#.##.#."]

inputTestH= ["#...##..#","#....#..#","..##..###","#####.##.","#####.##.","..##..###","#....#..#"]
input18 = ["#..####.##.##",".##.##.####.#","#######.##.##","####.........","#..##..####..","....##.#..#.#",".##..#.####.#","....#.#....#.",".....##....##",".##.##.#..#.#","#..##..#..#..","####.######.#",".....#.####.#",".##.##......#","#..##........"]


getScore :: (Int, Int) -> [String] -> Int
getScore er p = x + 100 * y
                where (x,y) = getReflectionLines er p 

getReflectionLines :: (Int, Int) -> [String] -> (Int, Int)
getReflectionLines (erx, ery) p = (findReflection (transpose p) erx, findReflection p ery)


findReflection :: [String] -> Int -> Int
findReflection p er   | isJust r = fromJust r
                        | otherwise = 0
                            where r = findReflection' er 1 [head p] (drop 1 p)

possiblePatterns :: [String] -> [[String]]
possiblePatterns p = map (mutate p) coordinates
                where coordinates = [(x,y) | x <- [0..length (head p) -1], y <- [0..length p - 1]]

mutate :: [String] -> (Int, Int) -> [String]
mutate p (x,y) = take y p ++ [newRow] ++ drop (y+1) p
                where 
                    newRow = take x oldRow ++ [flippedCell] ++ drop (x+1) oldRow
                    oldRow = p !! y
                    flippedCell = flipCell (oldRow !! x)

flipCell :: Char -> Char
flipCell '#' = '.'
flipCell '.' = '#'
flipCell _ = error "Usupported char"

findReflection' :: Int -> Int -> [String] -> [String] -> Maybe Int
findReflection' _ _ _ [] = Nothing
findReflection' r loc upper lower | r /= loc && drop (length upper - maxSize) upper == reverse (take maxSize lower) = Just loc
                                | otherwise = findReflection' r (loc + 1) (upper ++ [head lower]) (if not (null lower) then tail lower else [])
                                    where maxSize = min (length upper) (length lower)

getMutatedPatternWithReflection :: [String] -> Int
getMutatedPatternWithReflection p = getScore oldReflection $ head (filter (\pp -> getScore oldReflection pp > 0) (possiblePatterns p))
                                where oldReflection = getReflectionLines (0,0) p

part1, part2 :: [[String]] -> Int
part1 i = sum $ map (getScore(0,0)) i 
part2 i = sum $ map getMutatedPatternWithReflection i 